<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <title>เข้าสู่ระบบ</title>
    <link rel="stylesheet" href="/css/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body class="auth-page">
    <div class="auth-container">
        <div class="auth-header">
            <h1>My ADMIN</h1>
            <p>เข้าสู่ระบบเพื่อเข้าถึงฟีเจอร์ทั้งหมดของ ADMIN</p>
        </div>
        <form action="/auth/login" method="POST">
            <div class="form-group">
                <label>ชื่อผู้ใช้</label>
                <input type="text" name="username" required placeholder="กรอกชื่อผู้ใช้ของคุณ">
            </div>
            <div class="form-group">
                <label>รหัสผ่าน</label>
                <input type="password" name="password" required placeholder="กรอกรหัสผ่าน">
            </div>
            <button type="submit" class="btn btn-primary">เข้าสู่ระบบ</button>
        </form>

        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>
            document.getElementById("loginForm").addEventListener("submit", async function (event) {
                event.preventDefault(); // หยุดการรีโหลด

                const formData = new URLSearchParams(new FormData(this));

                const response = await fetch("/auth/login", {
                    method: "POST",
                    body: formData,
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                });

                const result = await response.json();

                if (result.success) {
                    Swal.fire({
                        icon: "success",
                        title: "เข้าสู่ระบบสำเร็จ!",
                        text: "กำลังนำคุณไปยังหน้า Dashboard...",
                        confirmButtonText: "ตกลง"
                    }).then(() => {
                        window.location.href = "/dashboard"; // ส่งไปหน้า dashboard
                    });
                } else {
                    Swal.fire({
                        icon: "error",
                        title: "เกิดข้อผิดพลาด!",
                        text: result.message,
                        confirmButtonText: "ลองอีกครั้ง"
                    });
                }
            });
        </script>


        <div class="auth-footer">
            <a href="/forgot-password">ลืมรหัสผ่าน?</a>
            <span>|</span>
            <a href="/auth/register">สมัครสมาชิก</a></p>
        </div>
    </div>
</body>

</html>